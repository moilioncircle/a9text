<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script language="javascript" src="../../com/trydofor/a9js/code/encoder.js"></script>
<script language="javascript" src="../../com/trydofor/a9js/code/des.js"></script>
<script language="javascript" src="../../com/trydofor/a9js/code/md5.js"></script>
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr  height="30">
    <td>
    <input type="button" onclick="md5sum()" value="md5sum" style="background-color:#99CC00"/> 
    <input type="button" onclick="enb64()"  value="base64 encode" style="background-color:#CC9900"/> 
    <input type="button" onclick="deb64()"  value="base64 decode" style="background-color:#CC9900"/> 
    <input type="button" onclick="endes()"  value="des encrypt" style="background-color:#0066FF"/> 
    <input type="button" onclick="dedes()"  value="des decrypt" style="background-color:#0066FF"/> 
    </td>
  </tr>
  <tr>
    <td>
        <textarea name="textarea" id="INPUT" style="width:100%; height:100%" ondblclick="this.select()"></textarea>
    </td>
  </tr>
  <tr>
    <td>
        <textarea name="textarea" id="OUTPUT" style="width:100%; height:100%" ondblclick="this.select()"></textarea>
    </td>
  </tr>
</table>

<script type="text/javascript">
var md5impl = new MD5Class();
var b64impl = new EncoderClass();
var desimpl = new DESClass();
var iptObj = document.getElementById("INPUT");
var optObj = document.getElementById("OUTPUT");

function md5sum()
{
    try{
        optObj.value = md5impl.hash(iptObj.value);
    }catch(e){
        alert("failed to get md5sum:"+e);
    }
}
function enb64()
{
    try{
        var ot = b64impl.base64Encode(b64impl.utf16to8(iptObj.value));
        optObj.value = format(ot);
    }catch(e){
        alert("failed to get base64 encode:"+e);
    }
}
function deb64()
{
    try{
        optObj.value = b64impl.utf8to16(b64impl.base64Decode(iptObj.value.replace(/\s/gm,'')));
    }catch(e){
        alert("failed to get base64 decode:"+e);
    }
}
function endes()
{
    try{
        var passwd = window.prompt('please input your passwd','');
        if(passwd ==null || passwd =='') return;
        
        var ot = desimpl.encrypt(passwd,iptObj.value);
        optObj.value = format(ot);
    }catch(e){
        alert("failed to get base64 encode:"+e);
    }
}
function dedes()
{
    try{
        var passwd = window.prompt('please input your passwd','');
        if(passwd ==null || passwd =='') return;
        
        optObj.value = desimpl.decrypt(passwd,iptObj.value.replace(/\s/gm,''));
    }catch(e){
        alert("failed to get base64 decode:"+e);
    }
}

function format(text)
{
    if(text == null || text =='') return text;
    
    var linesize = 64;
    
    text = text.replace(/\s+/g,'');
    var rtxt = [];
    for(var i=0;i<text.length;i+=linesize){
        var line = (i+linesize<text.length)?text.substr(i,linesize):text.substr(i);
        rtxt.push(line);
    }
    
    return rtxt.join('\n');
}
</script>
